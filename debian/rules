#!/usr/bin/make -f
# -*- makefile -*-

DH_VERBOSE := 1

%:
	dh $@ --with python-virtualenv

# do not call `make clean` as part of packaging
override_dh_auto_clean:
	true

override_dh_auto_build:
	true

# do not call `make test` as part of packaging
override_dh_auto_test:
	true

override_dh_virtualenv:
	echo $(PIP_INDEX_URL)
	dh_virtualenv --index-url $(PIP_INDEX_URL) \
                --python=/usr/bin/python3.8 \
                --preinstall no-manylinux1 \
                --preinstall cython \
                --preinstall pip-custom-platform \
                --preinstall pip==18.1 \
                --preinstall setuptools==46.1.3 \
                --pip-tool pip-custom-platform \
                --extra-pip-arg "-vvv"
	@echo patching k8s client lib
	patch debian/tron/opt/venvs/tron/lib/python3.8/site-packages/kubernetes/client/api_client.py contrib/python-k8s-client.diff

override_dh_installinit:
	dh_installinit --noscripts
